import{g as e,e as r,a,b as t,c as l}from"./statistics.483cbb5b.js";import{d as n,D as d,H as i,x as u,r as o,v as s,e as f,f as m,g as p,h as y,i as w,q as v,s as c,o as x,n as R}from"./vendor.9362f91f.js";import{_ as b}from"./index.23b6135c.js";const g=n({components:{DownOutlined:d},setup(){const n=window;let{state:d}=i(),f=u((()=>d.user.store));const m=o(!1),p=s({friendRewardType:"Percentage",friendRewardValue:"10",friendRewardExpiryInDays:10,referrerRewardType:"Percentage",referrerRewardValue:"10",referrerRewardExpiryInDays:10}),y=o(),w=o(),v=s({date:w}),c=s({arr:[]}),x=u({set:e=>{x.value=e},get:()=>"Percentage"===p.friendRewardType?100:999}),R=u({set:e=>{x.value=e},get:()=>"Percentage"===p.referrerRewardType?100:999}),b=()=>{r(f.value,{date:c.arr})},g=()=>{a(f.value,{date:c.arr})},E=()=>{t(f.value,{date:c.arr})},D=(e,r={})=>{l(e,r).then((e=>{n.$message.success("编辑成功！")}))},h=()=>e(d.user.store).then((e=>{const r=e.reward_settings;p.friendRewardType=r.friend.rewardType,p.friendRewardValue=r.friend.rewardValue,p.friendRewardExpiryInDays=r.friend.rewardExpiryInDays,p.referrerRewardType=r.referrer.rewardType,p.referrerRewardValue=r.referrer.rewardValue,p.referrerRewardExpiryInDays=r.referrer.rewardExpiryInDays}));return{visible:m,formState:p,referrerOptions:[{label:"Percentage",value:"Percentage"},{label:"Fixed amount",value:"Fixed amount"}],friendOptions:[{label:"Percentage",value:"Percentage"},{label:"Fixed amount",value:"Fixed amount"}],date:w,refData:c,formDate:v,formDateRef:y,dateFormat:"YYYY/MM/DD",maxFriendAmount:x,maxReferrerAmount:R,handleEdit:()=>{h().then((()=>{m.value=!0})).finally((()=>{m.value=!0}))},handleOk:()=>{m.value=!1;const{friendRewardType:e,friendRewardValue:r,friendRewardExpiryInDays:a,referrerRewardType:t,referrerRewardValue:l,referrerRewardExpiryInDays:n}=p,i=Object.assign({},{rewardType:e},{rewardValue:r.toString()},{rewardExpiryInDays:a}),u=Object.assign({},{rewardType:t},{rewardValue:l.toString()},{rewardExpiryInDays:n});D(d.user.store,{friend:i,referrer:u})},handleMenuClick:async e=>{if(await y.value.validateFields())switch(c.arr=[],w.value.map((e=>{c.arr.push(e.$d.toLocaleDateString())})),e.key){case"1":b();break;case"2":g();break;default:E()}},handleEditMerchant:D,handleExportreFerrals:b,handleExportFriends:g,handleExportOrders:E,handleGetMerchant:h}}}),E=e=>(v("data-v-8e68245a"),e=e(),c(),e),D={class:"home-container"},h={class:"title"},_=E((()=>p("h4",null,"Genki Forest Referral Program",-1))),T=R("编辑"),k=E((()=>p("h4",null,"Friend reward",-1))),S=E((()=>p("h4",null,"Referrer reward",-1))),I={class:"content"},O=R("Export Referrers"),V=R("Export Friends"),F=R("Export Orders"),P=R(" More ");var A=b(g,[["render",function(e,r,a,t,l,n){const d=f("a-button"),i=f("a-select"),u=f("a-form-item"),o=f("a-input-number"),s=f("a-form"),v=f("a-modal"),c=f("a-range-picker"),R=f("a-menu-item"),b=f("a-menu"),g=f("DownOutlined"),E=f("a-dropdown");return x(),m("div",D,[p("div",h,[_,y(d,{onClick:e.handleEdit},{default:w((()=>[T])),_:1},8,["onClick"])]),y(v,{visible:e.visible,"onUpdate:visible":r[6]||(r[6]=r=>e.visible=r),title:"Edit Referral Program",bodyStyle:{maxHeight:"600px",overflow:"auto"},onOk:e.handleOk},{default:w((()=>[y(s,{model:e.formState,name:"basic",labelAlign:"left",layout:"vertical",autocomplete:"off"},{default:w((()=>[k,y(u,{label:"Reward Type",name:"rewardType"},{default:w((()=>[y(i,{value:e.formState.friendRewardType,"onUpdate:value":r[0]||(r[0]=r=>e.formState.friendRewardType=r),options:e.friendOptions},null,8,["value","options"])])),_:1}),y(u,{label:"Amount",name:"amount"},{default:w((()=>[y(o,{id:"inputNumber",value:e.formState.friendRewardValue,"onUpdate:value":r[1]||(r[1]=r=>e.formState.friendRewardValue=r),min:0,max:e.maxFriendAmount},null,8,["value","max"])])),_:1}),y(u,{label:"Expiry in days",name:"expiry"},{default:w((()=>[y(o,{id:"inputNumber",value:e.formState.friendRewardExpiryInDays,"onUpdate:value":r[2]||(r[2]=r=>e.formState.friendRewardExpiryInDays=r),min:0,max:999},null,8,["value"])])),_:1}),S,y(u,{label:"Reward Type",name:"rewardType"},{default:w((()=>[y(i,{value:e.formState.referrerRewardType,"onUpdate:value":r[3]||(r[3]=r=>e.formState.referrerRewardType=r),options:e.referrerOptions},null,8,["value","options"])])),_:1}),y(u,{label:"Amount",name:"amount"},{default:w((()=>[y(o,{id:"inputNumber",value:e.formState.referrerRewardValue,"onUpdate:value":r[4]||(r[4]=r=>e.formState.referrerRewardValue=r),min:0,max:e.maxReferrerAmount},null,8,["value","max"])])),_:1}),y(u,{label:"Expiry in days",name:"expiry"},{default:w((()=>[y(o,{id:"inputNumber",value:e.formState.referrerRewardExpiryInDays,"onUpdate:value":r[5]||(r[5]=r=>e.formState.referrerRewardExpiryInDays=r),min:0,max:999},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","onOk"]),p("div",I,[y(s,{ref:"formDateRef",model:e.formDate,name:"basic",labelAlign:"left",layout:"vertical",autocomplete:"off"},{default:w((()=>[y(u,{label:"日期选择",name:"date",rules:[{required:!0,message:"请先选择日期！"}]},{default:w((()=>[y(c,{value:e.date,"onUpdate:value":r[7]||(r[7]=r=>e.date=r)},null,8,["value"])])),_:1})])),_:1},8,["model"]),y(E,null,{overlay:w((()=>[y(b,{onClick:e.handleMenuClick},{default:w((()=>[y(R,{key:"1"},{default:w((()=>[O])),_:1}),y(R,{key:"2"},{default:w((()=>[V])),_:1}),y(R,{key:"3"},{default:w((()=>[F])),_:1})])),_:1},8,["onClick"])])),default:w((()=>[y(d,{class:"more-btn"},{default:w((()=>[P,y(g)])),_:1})])),_:1})])])}],["__scopeId","data-v-8e68245a"]]);export{A as default};
