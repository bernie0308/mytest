import{d as e,P as a,f as t,h as l,i}from"./statistics.483cbb5b.js";import{d as o,r as d,H as s,x as n,v as u,e as c,f as p,g as r,h as m,i as v,F as _,m as y,o as b,O as f,t as h,j as g,n as F,q as k,s as C}from"./vendor.9362f91f.js";import{_ as D}from"./index.23b6135c.js";const x=o({name:"statistics",setup(){const o=d(!1),c=d(!1),p=d(!1),r=d(""),m=d(0),v=d(!1),_=d(),b=d([]),f=d(!1);let{state:h}=s(),g=n((()=>h.user.store));const F=d([]),k=d([]),C=d([]),D=d([]),x=d(0),w=d({}),O=u({product_id:null,discount_type:"percentage",is_active:!0,y_products:[{product_id:null,discount_value:"0"}]}),S=d([]),U=()=>{const e=O.y_products.map((e=>e.product_id));e.push(O.product_id),k.value.forEach((a=>{a.disabled=!1,e.includes(a.id)?a.disabled=!0:a.disabled=!1}))},L=()=>{e(g.value).then((e=>{C.value=e}))};L();const E=async()=>{await i(g.value).then((e=>{F.value=e,k.value=e,F.value.forEach((e=>{C.value.some((a=>a.product_id===e.id))?e.disabled=!0:e.disabled=!1}))}))},I=()=>a(g.value,{cs_x_product_id:x.value}).then((e=>{console.log(e,"-----")})),P=()=>{t(g.value,O).then((e=>{p.value=!1,v.value=!1,y.success("新增成功！"),L()}))},X=()=>{const e=Object.assign({},{product_id:m.value,discount_type:O.discount_type,y_products:O.y_products});l(g.value,e).then((e=>{p.value=!1,v.value=!1,y.success("编辑成功！"),L()}))},j=u([{value:"percentage",label:"percentage"},{value:"fixed_amount",label:"fixed_amount"}]);return{crossData:[{title:"产品名称",dataIndex:"name",key:"name"},{title:"产品图片",dataIndex:"image",key:"image"},{title:" ShopifyX产品ID",dataIndex:"product_id",key:"product_id"},{title:"折扣类型",key:"discount_type",dataIndex:"discount_type"},{title:"操作",key:"action"}],tabData:b,isShowOut:o,isShowEmit:c,addFormData:O,emitFormData:S,myFormRefs:r,formRef:_,isShowAdd:p,productDataX:F,productDataY:k,changeOptions:U,addSubmit:async()=>{try{await _.value.validateFields()&&(v.value=!0,f.value?X():P())}catch(e){console.log("Failed:",e)}},getProductListX:C,ProductDel:I,isEdit:f,delProduct:()=>{o.value=!1,I().then((()=>{y.success("删除成功！")})).finally((()=>{L()}))},x_product_id:x,emitCommodityName:async e=>{console.log(e),m.value=e.id,O.product_id=e.product_id,O.discount_type=e.discount_type,O.y_products=e.y_products,await E(),f.value=!0,p.value=!0},handleCreateProdduct:P,emitCommodityList:w,shoppingReduce:e=>{O.y_products.splice(e,1),U()},shoppingAdd:()=>{O.y_products.push({product_id:null,discount_value:"0"}),U()},add:()=>{O.product_id=null,O.discount_type="percentage",O.y_products=[{product_id:null,discount_value:"0"}],E(),f.value=!1,p.value=!0},cancel:()=>{},cancelOut:()=>{c.value=!1},out:e=>{x.value=e,o.value=!0},OutSubmit:()=>{o.value=!1},onFinish:e=>{console.log("Success:",e),c.value=!1},onFinishFailed:e=>{console.log("Failed:",e)},valueData:j,size:d("middle"),value1:d("a1"),tagId:D}}}),w=e=>(k("data-v-45b44fe5"),e=e(),C(),e),O={class:"box_add"},S=F("新增"),U={class:"box_tab"},L={key:0},E=[w((()=>r("image",{src:"@/assets/logo.jpg",mode:"scaleToFill"},null,-1)))],I={key:0},P=["src"],X={key:2},j={key:3},A=["onClick"],R=["onClick"],Y=w((()=>r("p",null,"是否删除该商品?",-1))),q={class:"box_form"},N=F("取消"),T=F("确定"),$=["spinning"],z={class:"box_select"},H=w((()=>r("span",{class:"discount"},"折扣: ",-1))),B={class:"box_but"},G=F(" + "),J=F(" - ");var K=D(x,[["render",function(e,a,t,l,i,o){const d=c("a-button"),s=c("a-divider"),n=c("a-table"),u=c("a-modal"),y=c("a-input"),F=c("a-form-item"),k=c("a-select"),C=c("a-form"),D=c("a-space");return b(),p(_,null,[r("div",O,[m(d,{class:"add_color",onClick:e.add},{default:v((()=>[S])),_:1},8,["onClick"])]),r("div",U,[m(n,{class:"tab",columns:e.crossData,"data-source":e.getProductListX,bordered:""},{headerCell:v((({column:e})=>["title"===e.key?(b(),p("span",L,E)):f("",!0)])),bodyCell:v((({column:a,record:t})=>["name"===a.key?(b(),p("a",I,h(t.title),1)):"image"===a.key?(b(),p("img",{key:1,class:"image_width",src:t.image,mode:"scaleToFill"},null,8,P)):"discount_type"===a.key?(b(),p("a",X,h(t.discount_type),1)):"action"===a.key?(b(),p("span",j,[r("a",null,h(t.name),1),r("a",{onClick:a=>e.emitCommodityName(t)},"编辑",8,A),m(s,{type:"vertical"}),r("a",{class:"ant-dropdown-link",onClick:a=>e.out(t.id)}," 删除 ",8,R)])):f("",!0)])),_:1},8,["columns","data-source"])]),r("div",null,[m(u,{visible:e.isShowOut,"onUpdate:visible":a[0]||(a[0]=a=>e.isShowOut=a),title:"温馨提示",onOk:e.delProduct},{default:v((()=>[Y])),_:1},8,["visible","onOk"])]),r("div",null,[m(u,{visible:e.isShowEmit,"onUpdate:visible":a[4]||(a[4]=a=>e.isShowEmit=a),title:"温馨提示",footer:null,onCancel:e.cancel},{default:v((()=>[r("div",q,[m(C,{model:e.emitCommodityList,name:"basic","label-col":{span:5},"wrapper-col":{span:16},autocomplete:"off",onFinish:e.onFinish,onFinishFailed:e.onFinishFailed},{default:v((()=>[m(F,{label:"产品名称"},{default:v((()=>[m(y,{value:e.emitCommodityList.title,"onUpdate:value":a[1]||(a[1]=a=>e.emitCommodityList.title=a)},null,8,["value"])])),_:1}),m(F,{label:"产品ID"},{default:v((()=>[m(y,{value:e.emitCommodityList.product_id,"onUpdate:value":a[2]||(a[2]=a=>e.emitCommodityList.product_id=a)},null,8,["value"])])),_:1}),m(F,{label:"折扣类型"},{default:v((()=>[m(k,{class:"price_list",value:e.emitCommodityList.discount_type,"onUpdate:value":a[3]||(a[3]=a=>e.emitCommodityList.discount_type=a),options:e.valueData},null,8,["value","options"])])),_:1}),m(F,{"wrapper-col":{offset:8,span:16}},{default:v((()=>[m(d,{style:{"margin-left":"10px"},onClick:e.cancelOut},{default:v((()=>[N])),_:1},8,["onClick"]),m(d,{type:"primary","html-type":"submit"},{default:v((()=>[T])),_:1})])),_:1})])),_:1},8,["model","onFinish","onFinishFailed"])])])),_:1},8,["visible","onCancel"])]),r("div",{spinning:e.spinning},[m(u,{visible:e.isShowAdd,"onUpdate:visible":a[7]||(a[7]=a=>e.isShowAdd=a),width:"1000px",title:e.isEdit?"编辑":"新增",onCancel:e.cancel,onOk:e.addSubmit},{default:v((()=>[r("div",z,[m(C,{model:e.addFormData,name:"basic",ref:"formRef","label-col":{span:5},"wrapper-col":{span:16},autocomplete:"off",onFinish:e.onFinish,onFinishFailed:e.onFinishFailed},{default:v((()=>[m(F,{name:"product_id",label:"产品X",rules:[{required:!0,message:"请输入产品X"}]},{default:v((()=>[m(k,{value:e.addFormData.product_id,"onUpdate:value":a[5]||(a[5]=a=>e.addFormData.product_id=a),disabled:e.isEdit,"field-names":{label:"title",value:"id"},options:e.productDataX,onChange:e.changeOptions},null,8,["value","disabled","options","onChange"])])),_:1}),m(F,{label:"折扣类型"},{default:v((()=>[m(k,{value:e.addFormData.discount_type,"onUpdate:value":a[6]||(a[6]=a=>e.addFormData.discount_type=a),options:e.valueData},null,8,["value","options"])])),_:1}),(b(!0),p(_,null,g(e.addFormData.y_products,((a,t)=>(b(),p("div",{key:t,class:"box_price"},[m(F,{name:["y_products",t,"product_id"],label:`产品Y ${t+1}`,rules:[{required:!0,message:`请输入产品Y${t+1}`}]},{default:v((()=>[m(k,{class:"price_list",value:a.product_id,"onUpdate:value":e=>a.product_id=e,"field-names":{label:"title",value:"id"},options:e.productDataY,onChange:e.changeOptions},null,8,["value","onUpdate:value","options","onChange"])])),_:2},1032,["name","label","rules"]),m(F,{name:"area"},{default:v((()=>[H,m(y,{class:"box_inp",value:a.discount_value,"onUpdate:value":e=>a.discount_value=e},null,8,["value","onUpdate:value"])])),_:2},1024),r("span",B,[m(D,null,{default:v((()=>[m(d,{shape:"circle",onClick:e.shoppingAdd},{default:v((()=>[G])),_:1},8,["onClick"]),m(d,{disabled:0===t,shape:"circle",onClick:a=>e.shoppingReduce(t)},{default:v((()=>[J])),_:2},1032,["disabled","onClick"])])),_:2},1024)])])))),128))])),_:1},8,["model","onFinish","onFinishFailed"])])])),_:1},8,["visible","title","onCancel","onOk"])],8,$)],64)}],["__scopeId","data-v-45b44fe5"]]);export{K as default};
